version: '3.8'

services:
  # 1. ฐานข้อมูล Service (MySQL)
  db:
    image: mysql:8.0
    container_name: mysql_db_dev
    restart: always
    environment:
      # **กำหนดค่าฐานข้อมูล**
      MYSQL_ROOT_PASSWORD: rootpassword
      MYSQL_USER: myuser 
      MYSQL_PASSWORD: mypassword 
      MYSQL_DATABASE: Buffet
    ports:
      # พอร์ตสำหรับการเข้าถึง DB จากเครื่องโฮสต์ (ตัวเลือก)
      - "3306:3306" 
    volumes:
      # **สำคัญ:** เก็บข้อมูล DB อย่างถาวร
      - mysql_data:/var/lib/mysql
      # Auto-initialize database with schema
      - ./Buffet-MySQL.sql:/docker-entrypoint-initdb.d/init.sql

  # 2. แอปพลิเคชัน Service (เว็บ)
  # Commented out until Dockerfile is created
  # web:
  #   # หากคุณใช้ Dockerfile ในโฟลเดอร์เดียวกัน
  #   build: . 
  #   # หรือใช้ image สำเร็จรูป: image: yourname/app:tag
  #   container_name: my_app_web_dev
  #   ports:
  #     # แมปพอร์ตโฮสต์:คอนเทนเนอร์ (สมมติแอปใช้พอร์ต 80)
  #     - "8080:80"
  #   environment:
  #     # **กำหนดค่าการเชื่อมต่อ DB ให้แอป**
  #     DB_HOST: db        # ใช้ชื่อ Service 'db' เป็น Hostname
  #     DB_PORT: 3306
  #     DB_USER: myuser
  #     DB_PASSWORD: mypassword
  #     DB_NAME: Buffet
  #   depends_on:
  #     # บอกให้ Docker Compose เริ่ม 'db' ก่อน 'web'
  #     - db
    
volumes:
  # กำหนด Named Volume สำหรับ Service 'db'
  mysql_data:
